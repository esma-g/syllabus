<!DOCTYPE html>




<html lang="en-gb">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>CYF&#43;</title>
    <meta name="description" content="A free and open source immersive engineering programme. Practical, hands on projects in Go, distributed systems engineering, site reliability engineering, software engineering. Pace, scale, and complexity." />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    
    <style>
      body,
      html {
        margin: 0;
        padding: 0;
        height: 100%;
        animation: fade-in 0.2s;
      }
      @keyframes fade-in {
        0% {
          opacity: 0;
        }
        100% {
          opacity: 1;
        }
      }
    </style>
     
    <link
      rel="stylesheet"
      href="/bundled.min.f44ec27dd539fe9647de9751483e4bcd.css"
      media="print"
      onload="this.media='all'"
    />
    <noscript>
      <link rel="stylesheet" href="/bundled.min.f44ec27dd539fe9647de9751483e4bcd.css" />
    </noscript>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Hanken+Grotesk:wght@300;400;700&family=Major+Mono+Display&display=swap"
      rel="stylesheet"
      media="print"
      onload="this.media='all'"
    />

    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="/favicons/apple-touch-icon.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="/favicons/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="/favicons/favicon-16x16.png"
    />
    <link rel="manifest" href="/favicons/site.webmanifest" />
    <link rel="shortcut icon" href="/favicons/favicon.ico" />
    <meta name="apple-mobile-web-app-title" content="CYF+" />
    <meta name="application-name" content="CYF+" />
    <meta name="msapplication-TileColor" content="#9f00a7" />
    <meta
      name="msapplication-config"
      content="/favicons/browserconfig.xml"
    />
    <meta name="theme-color" content="#00ff90" />
  </head>
</html>
<body class="is-light-mode">
  <a class="c-skip-link e-button" id="skip-link" href="#main">Skip to main</a>
  <div class="l-layout">
    <header class="l-layout__header l-header">
  <div class="l-header__nav">
    <h1 class="l-header__heading">
      <a class="l-header__home" href="/">CYF&#43;</a>
    </h1>

    <button
      class="l-header__action e-button e-button--icon js-menu-toggle is-fixed"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 24 24"
        stroke-width="1.5"
        stroke="currentColor"
        class="e-button__icon l-header__icon"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M12 6.75a.75.75 0 110-1.5.75.75 0 010 1.5zM12 12.75a.75.75 0 110-1.5.75.75 0 010 1.5zM12 18.75a.75.75 0 110-1.5.75.75 0 010 1.5z"
        />
      </svg>

      <span class="is-invisible">Open Menu.</span>
    </button>
  </div>
</header>
 <nav
  class="l-layout__menu l-menu"
  aria-label="Main Site Links."
  id="site-menu"
  hidden
  tabindex="0"
>
  <div class="l-menu__container">
    <h2 class="l-menu__heading e-heading__2">
      <a href="/" class="l-menu__home">CYF&#43;</a>
    </h2>
    <button
      class="l-menu__action e-button e-button--icon js-menu-toggle"
      id="close-menu"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 24 24"
        stroke-width="1.5"
        stroke="currentColor"
        class="e-button__icon"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M6 18L18 6M6 6l12 12"
        />
      </svg>

      <span class="is-invisible">Close Menu.</span>
    </button>
    <ul class="l-menu__primary e-list">
      <li class="l-menu__item e-list__item">
        <a class="l-menu__link e-link e-heading__1" href="/about">About</a>
      </li>
      <li class="l-menu__item e-list__item">
        <a class="l-menu__link e-link e-heading__1" href="/versions"
          >Versions</a
        >
      </li>
      <li class="l-menu__item e-list__item">
        <a class="l-menu__link e-link e-heading__1" href="/projects"
          >Projects</a
        >
      </li>
      <li class="l-menu__item e-list__item">
        <a class="l-menu__link e-link e-heading__1" href="/primers">Primers</a>
      </li>
    </ul>

    <div class="l-menu__secondary">
      
      <a class="l-menu__link e-link" href="#skip-link">
        <span class="is-invisible">To top</span>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          width="48px"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
          class="l-menu__icon"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M3 4.5h14.25M3 9h9.75M3 13.5h5.25m5.25-.75L17.25 9m0 0L21 12.75M17.25 9v12"
          />
        </svg>
      </a>
      
    </div>
  </div>

  <img
    src="/pictures/depths/dddepth--005.webp"
    alt=""
    class="l-menu__bg"
  />
</nav>

    <main id="main" class="l-layout__main l-main" tabindex="0">
      

<article>
  <header class="l-page__header c-page-header">
    <div class="c-page-header__container">
      <div class="c-page-header__breadcrumbs">
        
<nav class="c-breadcrumbs">
  <ol class="c-breadcrumbs__list">
    <li class="c-breadcrumbs__item">
      <a class="c-breadcrumbs__link" href="/projects/">Projects</a>
    </li>
  </ol>
</nav>


      </div>
      <h1
        class="c-page-header__title e-heading__1 is-invisible"
      >
        Buggy App
      </h1>
         
      <a
        class="c-page-header__edit e-heading__5 e-link is-none--lt-container"
        href="https://github.com/CodeYourFuture/immersive-go-course/tree/main/projects/buggy-app/README.md"
        >Edit on Github</a
      >
       

  

  


<h2 class="c-lastmod c-page-header__lastmod">
  .Lastmod
  <a href="https://github.com/CodeYourFuture/immersive-go-course/tree/main/buggy-app">
    <time datetime="2023-01-08T15:59:51Z">2023-01-08T15:59:51Z</time>
  </a>
</h2>

  
      <section class="c-page-header__toc c-toc" id="toc">
        <nav id="TableOfContents">
  <ol>
    <li><a href="#learning-objectives">Learning objectives:</a></li>
    <li><a href="#project">Project</a>
      <ol>
        <li><a href="#output">Output</a></li>
        <li><a href="#getting-started">Getting started</a></li>
      </ol>
    </li>
    <li><a href="#notes-app">Notes App</a></li>
    <li><a href="#api">API</a></li>
    <li><a href="#database">Database</a>
      <ol>
        <li><a href="#user"><code>user</code></a></li>
        <li><a href="#note"><code>note</code></a></li>
      </ol>
    </li>
    <li><a href="#structure">Structure</a></li>
    <li><a href="#running">Running</a></li>
    <li><a href="#tests">Tests</a></li>
    <li><a href="#migrations">Migrations</a></li>
    <li><a href="#test-data">Test data</a>
      <ol>
        <li><a href="#user-1"><code>user</code></a></li>
        <li><a href="#note-1"><code>note</code></a></li>
      </ol>
    </li>
  </ol>
</nav>
      </section>
      
    </div>
  </header>

  <section class="l-page__main c-copy"><p>In this project, you&rsquo;re going to run, debug, and fix a buggy application. This code here is a &ldquo;notes&rdquo; application with users and notes. It simulates a real-world application that has grown and developed over time: the code isn&rsquo;t perfect, there are tests missing and it contains bugs. The task is to find and fix these bugs. There are <em>at least</em> 5 distinct and important bugs for you to find a fix.</p>
<blockquote>
<p><strong>Note:</strong> This project requires you to have Docker with <a href="https://docs.docker.com/compose/">Compose</a> installed. Compose is a tool for defining and running multi-container Docker applications. With Compose, we use a YAML file to configure the application’s services. Then, with a single command, we create and start all the services from the configuration.</p>
</blockquote>
<h2 id="learning-objectives">Learning objectives:</h2>
<ul>
<li>How can we quickly read, understand and fix existing application code?</li>
<li>How do we QA running code by thinking about security, edge cases and performance?</li>
<li>How do we ensure safe data access with authentication &amp; authorisation?</li>
<li>What are some common architectures for services in tech companies?</li>
</ul>
<h2 id="project">Project</h2>
<p>The goal is to find and fix at least 5 bugs. There are issues in the logic, performance, and authorisation (that we know about). There could be more! Find and fix as many as you can in the time.</p>
<ul>
<li>Read the documentation below carefully to understand the application&rsquo;s intended behaviour (Idea: write down what you find as you read)</li>
<li>Read the code to identify how the main pieces fit together and work</li>
<li>Make sure the main features work</li>
<li>Identify and test the access controls and <a href="https://en.m.wikipedia.org/wiki/Edge_case">edge cases</a></li>
</ul>
<h3 id="output">Output</h3>
<p>To capture the bugs you find, fork this repository and open an issue for each bug. The issue you open should be a high-quality bug report, containing:</p>
<ul>
<li>A summary of the issue</li>
<li>Information about your setup (operating system, how you were running it)</li>
<li>Steps to replicate the issue</li>
<li>The expected result</li>
<li>The <em>actual</em> result you saw as a result of the bug</li>
<li>Evidence of the issue (e.g. screenshots or command output)</li>
</ul>
<p>As an extension, open a Pull Request against your repository that fixes each issue, one PR per issue. You can <a href="https://docs.github.com/en/issues/tracking-your-work-with-issues/linking-a-pull-request-to-an-issue">link a Pull Request to an issue</a> too.</p>
<h3 id="getting-started">Getting started</h3>
<p>Here are a couple of bug reports to get you started - feel free to read them if you want some ideas, or to save them for after you&rsquo;ve done some bug hunting if you&rsquo;d prefer:</p>
<details><summary>Bug report #1</summary>An (imaginary) user of our app has reported that the note "#Monday Remember to take time for self-care" was behaving strangely... the tags didn't look right.</details>
<details><summary>Bug report #2</summary>Another user reported a bug where they deactivated their account, but were still able to see their notes. What's going on there?</details>
<h2 id="notes-app">Notes App</h2>
<p>There are two services and a database in this project:</p>
<ol>
<li>API service: authenticate and get notes over HTTP</li>
<li>Auth service: gRPC service for verifying authentication information</li>
<li>Database: Postgres storing users and notes</li>
</ol>
<p>Here&rsquo;s how requests flow through the architecture diagram below:</p>
<ol>
<li>An HTTP request hits API service with HTTP basic auth</li>
<li>The API uses the Auth Client to check the authentication information</li>
<li>Auth Client calls Auth Service over gRPC, which verifies credentials against User table in the database</li>
<li>Once validated, the API allows request to continue to retrieve Note data from the database</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>               ┌───────────────────────────────────────┐      ┌─────────────────┐
</span></span><span style="display:flex;"><span>               │              API Service              │      │       DB        │
</span></span><span style="display:flex;"><span>               │                                       │      │                 │
</span></span><span style="display:flex;"><span>               │ ┌────────────┐           ┌─────────┐  │      │                 │
</span></span><span style="display:flex;"><span>     ┌────┐    │ │            │           │         │  │      │ ┌─────────────┐ │
</span></span><span style="display:flex;"><span>     │HTTP│    │ │            │           │         │  │      │ │             │ │
</span></span><span style="display:flex;"><span>─────┴────┴────┼▶│    Auth    │──────────▶│  Notes  │──┼──────┼▶│    Notes    │ │
</span></span><span style="display:flex;"><span>               │ │            │           │         │  │      │ │             │ │
</span></span><span style="display:flex;"><span>               │ │            │           │         │  │      │ └─────────────┘ │
</span></span><span style="display:flex;"><span>               │ └────────────┘           └─────────┘  │      │                 │
</span></span><span style="display:flex;"><span>               │        ▲                              │      │                 │
</span></span><span style="display:flex;"><span>               └────────┼──────────────────────────────┘      │                 │
</span></span><span style="display:flex;"><span>                        ├────┐                                │                 │
</span></span><span style="display:flex;"><span>                        │gRPC│                                │                 │
</span></span><span style="display:flex;"><span>                        ├────┘                                │                 │
</span></span><span style="display:flex;"><span>                        ▼                                     │                 │
</span></span><span style="display:flex;"><span>                ┌──────────────┐                              │ ┌─────────────┐ │
</span></span><span style="display:flex;"><span>                │              │                              │ │             │ │
</span></span><span style="display:flex;"><span>                │ Auth Service │──────────────────────────────┼▶│    Users    │ │
</span></span><span style="display:flex;"><span>                │              │                              │ │             │ │
</span></span><span style="display:flex;"><span>                └──────────────┘                              │ └─────────────┘ │
</span></span><span style="display:flex;"><span>                                                              └─────────────────┘
</span></span></code></pre></div><h2 id="api">API</h2>
<ul>
<li><code>GET /1/my/notes.json</code> &ndash; Get all notes owned by the authenticated user</li>
<li><code>GET /1/my/notes/:id.json</code> &ndash; Get a specific note owned by the authenticated user</li>
</ul>
<p>Authentication is by <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Authentication">basic auth</a>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>&gt; curl 127.0.0.1:8090/1/my/notes.json <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>	-H &#39;Authorization: Basic QTJSUHE2VG86YmFuYW5h&#39; -i
</span></span><span style="display:flex;"><span>HTTP/1.1 200 OK
</span></span><span style="display:flex;"><span>Content-Type: text/json
</span></span><span style="display:flex;"><span>Date: Sun, 16 Oct 2022 09:45:03 GMT
</span></span><span style="display:flex;"><span>Content-Length: 162
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>{&#34;notes&#34;:[{&#34;id&#34;:&#34;JBmytGF3&#34;,&#34;owner&#34;:&#34;A2RPq6To&#34;,&#34;content&#34;:&#34;Example note content with tags #example and #another&#34;,&#34;created&#34;:&#34;2022-10-15T19:48:19.597524Z&#34;,&#34;modified&#34;:&#34;2022-10-15T19:48:19.597524Z&#34;, &#34;tags&#34;: [&#34;example&#34;, &#34;another&#34;]}]}
</span></span></code></pre></div><p>The API exposes the &ldquo;tags&rdquo; associated with a Note. These are not stored, but are extracted as notes are read from the database.</p>
<h2 id="database">Database</h2>
<p>The database is Postgres. This is the table structure:</p>
<h3 id="user"><code>user</code></h3>
<ul>
<li><code>id</code>: primary key: randomly generated string, like <code>A2RPq6To</code></li>
<li><code>status</code>: string (<code>inactive</code> or <code>active</code>)</li>
<li><code>password</code>: bcrypt string</li>
<li><code>created</code>: timestamp</li>
<li><code>modified</code>: timestamp</li>
</ul>
<p>Users with status <code>inactive</code> should not be able to authenticate or access their notes.</p>
<h3 id="note"><code>note</code></h3>
<ul>
<li><code>id</code>: primary key: randomly generated string, like <code>JBmytGF3</code></li>
<li><code>owner</code>: foreign key for a user</li>
<li><code>content</code>: text, contents of the Note</li>
<li><code>created</code>: timestamp</li>
<li><code>modified</code>: timestamp</li>
</ul>
<p>Users should not be able to access notes that they do not own.</p>
<h2 id="structure">Structure</h2>
<p>Here&rsquo;s what each directory contains:</p>
<ul>
<li><code>api</code>: The HTTP API service
<ul>
<li><code>model</code>: Code for interacting with notes in the database</li>
</ul>
</li>
<li><code>assets</code>: Static files relating to the application (e.g. <code>.monopic</code> architecture file)</li>
<li><code>auth</code>: The Auth service that verifies authentication information supplied to the API service, and an Client that the API service uses to talk to the Auth service
<ul>
<li><code>cache</code>: A caching package that stores previously verified authentication information</li>
<li><code>service</code>: Protocol Buffer code (<code>.proto</code> and generated <code>.go</code>) for the gRPC service</li>
</ul>
</li>
<li><code>bin</code>: Executable scripts that are used within the Dockerfile</li>
<li><code>cmd</code>: Command line tools for running the application, setting up the database and generating data for testing
<ul>
<li><code>api</code>: Run the API service</li>
<li><code>auth</code>: Run the Auth service</li>
<li><code>migrate</code>: Set up the database. See <a href="#migrations">Migrations</a> below.</li>
</ul>
</li>
<li><code>migrations</code>: <code>sql</code> files for the migrations, setting up <code>user</code> and <code>note</code> tables</li>
<li><code>util</code>: Shared code across the other directories</li>
<li><code>volumes</code>: Directories that will be mounted into the containers
<ul>
<li><code>init</code>: <a href="https://github.com/docker-library/docs/blob/master/postgres/README.md#initialization-scripts">Scripts for initialising the Postgres database</a></li>
<li><code>secrets</code>: Created when the app is run. Contains secrets such as the <code>postgres</code> user password.</li>
</ul>
</li>
</ul>
<p>In addition there are some important files:</p>
<ul>
<li><code>docker-compose.yml</code>: Configuration for <code>docker compose</code>, specifying how the database, services, migrations and tests run within docker</li>
<li><code>Dockerfile</code>: Build configuration for the application. The whole repository is built with the same <code>Dockerfile</code> configuration, with different commands available (those in the <code>cmd</code> directory). See the <code>docker-compose.yml</code> file for details on how each service actually runs.</li>
<li><code>Makefile</code>: Commands for setting-up, testing, migrating, and running the application. The important commands are:
<ul>
<li><code>migrate</code>: Runs migrations against Postgres. May also do initialisation if required.</li>
<li><code>test</code>: Runs tests. May also do initialisation if required.</li>
<li><code>build-run</code>: Builds and runs the whole application.</li>
</ul>
</li>
</ul>
<h2 id="running">Running</h2>
<p>Use <code>make build run</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>&gt; make build run
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>buggy-app-postgres-1  | 2022-10-16 09:41:48.815 UTC [1] LOG:  database system is ready to accept connections
</span></span><span style="display:flex;"><span>buggy-app-auth-1      | wait-for-it.sh: postgres:5432 is available after 1 seconds
</span></span><span style="display:flex;"><span>buggy-app-auth-1      | 2022/10/16 09:41:48 auth service: listening: :80
</span></span><span style="display:flex;"><span>buggy-app-api-1       | wait-for-it.sh: postgres:5432 is available after 1 seconds
</span></span><span style="display:flex;"><span>buggy-app-api-1       | 2022/10/16 09:41:49 api service: listening: :80
</span></span></code></pre></div><p>Once it&rsquo;s running, the port of the API will be available (<code>8090</code>) which we can see via <code>docker compose ps</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>&gt; docker compose ps
</span></span><span style="display:flex;"><span>NAME                   COMMAND                  SERVICE             STATUS              PORTS
</span></span><span style="display:flex;"><span>buggy-app-api-1        &#34;/bin/docker-entrypo…&#34;   api                 running             127.0.0.1:8090-&gt;80/tcp
</span></span><span style="display:flex;"><span>buggy-app-auth-1       &#34;/bin/docker-entrypo…&#34;   auth                running             127.0.0.1:8080-&gt;80/tcp
</span></span><span style="display:flex;"><span>buggy-app-postgres-1   &#34;docker-entrypoint.s…&#34;   postgres            running             0.0.0.0:5432-&gt;5432/tcp
</span></span></code></pre></div><p>Under the hood, we&rsquo;re using <code>docker compose</code> to coordinate startup.</p>
<p><code>bin/wait-for-it.sh</code> is used extensively to make sure that Postgres is available before the other services are started.</p>
<p>We can also re-run everything without rebuilding: <code>make run</code></p>
<h2 id="tests">Tests</h2>
<p>To run the tests of this project, run:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>&gt; make test
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>ok  	github.com/CodeYourFuture/immersive-go-course/buggy-app/api	2.051s
</span></span><span style="display:flex;"><span>?   	github.com/CodeYourFuture/immersive-go-course/buggy-app/api/model	[no test files]
</span></span><span style="display:flex;"><span>ok  	github.com/CodeYourFuture/immersive-go-course/buggy-app/auth	5.974s
</span></span><span style="display:flex;"><span>ok  	github.com/CodeYourFuture/immersive-go-course/buggy-app/auth/cache	0.002s
</span></span><span style="display:flex;"><span>?   	github.com/CodeYourFuture/immersive-go-course/buggy-app/auth/service	[no test files]
</span></span><span style="display:flex;"><span>?   	github.com/CodeYourFuture/immersive-go-course/buggy-app/cmd/api	[no test files]
</span></span><span style="display:flex;"><span>?   	github.com/CodeYourFuture/immersive-go-course/buggy-app/cmd/auth	[no test files]
</span></span><span style="display:flex;"><span>?   	github.com/CodeYourFuture/immersive-go-course/buggy-app/cmd/migrate	[no test files]
</span></span><span style="display:flex;"><span>?   	github.com/CodeYourFuture/immersive-go-course/buggy-app/cmd/test	[no test files]
</span></span><span style="display:flex;"><span>?   	github.com/CodeYourFuture/immersive-go-course/buggy-app/util	[no test files]
</span></span><span style="display:flex;"><span>?   	github.com/CodeYourFuture/immersive-go-course/buggy-app/util/authuserctx	[no test files]
</span></span></code></pre></div><p><strong>Important:</strong> the tests run <strong>inside Docker</strong> and rely on a fully <a href="#Migrations">migrated</a> Postgres. Always running via <code>make</code> should ensure this is the case.</p>
<h2 id="migrations">Migrations</h2>
<p>In this context, database migrations are SQL files (<code>.sql</code>) that specify how the data should be setup. They are ordered, and the order is very important: each migration file builds on the previous migrations so that we get a fully working database state at the end. The migration files are used to set up database tables, plus functions and triggers for generating random IDs.</p>
<p>Each migration has an &ldquo;up&rdquo; and &ldquo;down&rdquo; script which performs the migration and undoes it, respectively.</p>
<p>The migration process is performed by the code in <code>cmd/migrate</code> using the <a href="https://github.com/golang-migrate/migrate">migrate package</a>.</p>
<p>To run migrations:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>&gt; make migrate
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>2022/10/16 10:17:19 migrate: &#34;file:///migrations/app&#34; into &#34;app&#34; database
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>2022/10/16 10:17:19 migrate: complete
</span></span></code></pre></div><p><strong>Important:</strong> the migrations run <strong>inside Docker</strong>. Always run them via <code>make</code>.</p>
<h2 id="test-data">Test data</h2>
<p>You can generate test data using <code>cmd/test</code>. There are two commands, <code>user</code> and <code>note</code>. These are useful for setting up test scenarios. The database needs to be running: <code>make run</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>&gt; go run ./cmd/test user -password banana
</span></span><span style="display:flex;"><span>	2022/10/16 16:40:56 new user created
</span></span><span style="display:flex;"><span>	2022/10/16 16:40:56 	id: FxoAB2gl
</span></span><span style="display:flex;"><span>	2022/10/16 16:40:56 	password: banana
</span></span><span style="display:flex;"><span>	2022/10/16 16:40:56 base64 for auth: RnhvQUIyZ2w6YmFuYW5h
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010"></span>&gt; go run ./cmd/test note -owner FxoAB2gl
</span></span><span style="display:flex;"><span>	2022/10/16 16:41:42 new note created
</span></span><span style="display:flex;"><span>	2022/10/16 16:41:42 	id: 0fxh25SJ
</span></span><span style="display:flex;"><span>	2022/10/16 16:41:42 	owner: FxoAB2gl
</span></span><span style="display:flex;"><span>	2022/10/16 16:41:42 	content: &#34;Example note content&#34;
</span></span></code></pre></div><h3 id="user-1"><code>user</code></h3>
<p>Example that generates 3 <code>active</code> users with the password <code>banana</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>&gt; go run ./cmd/test user -password banana -status inactive -n <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>2022/10/16 21:19:48 new user created
</span></span><span style="display:flex;"><span>2022/10/16 21:19:48 	id: VcKtJ4Nx
</span></span><span style="display:flex;"><span>2022/10/16 21:19:48 	status: inactive
</span></span><span style="display:flex;"><span>2022/10/16 21:19:48 	password: banana
</span></span><span style="display:flex;"><span>2022/10/16 21:19:48 base64 for auth: VmNLdEo0Tng6YmFuYW5h
</span></span><span style="display:flex;"><span>2022/10/16 21:19:48 new user created
</span></span><span style="display:flex;"><span>2022/10/16 21:19:48 	id: 73AY1VfS
</span></span><span style="display:flex;"><span>2022/10/16 21:19:48 	status: inactive
</span></span><span style="display:flex;"><span>2022/10/16 21:19:48 	password: banana
</span></span><span style="display:flex;"><span>2022/10/16 21:19:48 base64 for auth: NzNBWTFWZlM6YmFuYW5h
</span></span><span style="display:flex;"><span>2022/10/16 21:19:48 new user created
</span></span><span style="display:flex;"><span>2022/10/16 21:19:48 	id: TnKZvNFl
</span></span><span style="display:flex;"><span>2022/10/16 21:19:48 	status: inactive
</span></span><span style="display:flex;"><span>2022/10/16 21:19:48 	password: banana
</span></span><span style="display:flex;"><span>2022/10/16 21:19:48 base64 for auth: VG5LWnZORmw6YmFuYW5h
</span></span></code></pre></div><p>Usage of <code>user</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  -db string
</span></span><span style="display:flex;"><span>		target database (default &#34;app&#34;)
</span></span><span style="display:flex;"><span>  -hostport string
</span></span><span style="display:flex;"><span>		host:port of Postgres (default &#34;localhost:5432&#34;)
</span></span><span style="display:flex;"><span>  -n int
</span></span><span style="display:flex;"><span>		number of entities to generate (default 1)
</span></span><span style="display:flex;"><span>  -password string
</span></span><span style="display:flex;"><span>		password of the created user (default &#34;password&#34;)
</span></span><span style="display:flex;"><span>  -status string
</span></span><span style="display:flex;"><span>		status of the created user (default &#34;active&#34;)
</span></span></code></pre></div><h3 id="note-1"><code>note</code></h3>
<p>Example that generates 3 notes, owned by user <code>TnKZvNFl</code>, with the content <code>This note has a #tag</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-console" data-lang="console"><span style="display:flex;"><span>&gt; go run ./cmd/test note -owner TnKZvNFl -content <span style="color:#e6db74">&#34;This note has a #tag&#34;</span> -n <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>2022/10/16 21:21:01 new note created
</span></span><span style="display:flex;"><span>2022/10/16 21:21:01 	id: 7_sI25qa
</span></span><span style="display:flex;"><span>2022/10/16 21:21:01 	owner: TnKZvNFl
</span></span><span style="display:flex;"><span>2022/10/16 21:21:01 	content: &#34;This note has a #tag&#34;
</span></span><span style="display:flex;"><span>2022/10/16 21:21:01 new note created
</span></span><span style="display:flex;"><span>2022/10/16 21:21:01 	id: 2hcmUDzb
</span></span><span style="display:flex;"><span>2022/10/16 21:21:01 	owner: TnKZvNFl
</span></span><span style="display:flex;"><span>2022/10/16 21:21:01 	content: &#34;This note has a #tag&#34;
</span></span><span style="display:flex;"><span>2022/10/16 21:21:01 new note created
</span></span><span style="display:flex;"><span>2022/10/16 21:21:01 	id: dcd9kMNo
</span></span><span style="display:flex;"><span>2022/10/16 21:21:01 	owner: TnKZvNFl
</span></span><span style="display:flex;"><span>2022/10/16 21:21:01 	content: &#34;This note has a #tag&#34;
</span></span></code></pre></div><p>Usage of <code>note</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>  -content string
</span></span><span style="display:flex;"><span>		content of the created note (default &#34;Example note content&#34;)
</span></span><span style="display:flex;"><span>  -db string
</span></span><span style="display:flex;"><span>		target database (default &#34;app&#34;)
</span></span><span style="display:flex;"><span>  -hostport string
</span></span><span style="display:flex;"><span>		host:port of Postgres (default &#34;localhost:5432&#34;)
</span></span><span style="display:flex;"><span>  -n int
</span></span><span style="display:flex;"><span>		number of entities to generate (default 1)
</span></span><span style="display:flex;"><span>  -owner string
</span></span><span style="display:flex;"><span>		owner of the created note
</span></span></code></pre></div></section>

  
<footer class="c-page-footer c-copy">
  <h4 class="c-page-footer__section">
    <a
      class="c-page-footer__section-link e-link"
      href="/projects"
      >projects</a
    >
  </h4>
   
  <nav class="c-page-footer__section-nav">
    <a
      class="e-button e-button--icon c-page-footer__edit"
      href="https://github.com/CodeYourFuture/immersive-go-course/tree/main/projects/buggy-app/README.md"
      ><svg
        role="presentation"
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 24 24"
        stroke-width="1.5"
        stroke="currentColor"
        class="e-button__icon"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"
        />
      </svg>
      <span class="is-invisible">Edit this page on GitHub</span></a
    >
    
    
  </nav>
</footer>


</article>


    </main><footer class="l-layout__footer l-footer">
  <a
    class="l-footer__github e-button e-button--icon"
    href="https://github.com/CodeYourFuture/immersive-go-course/"
  >
    <svg
      focusable="false"
      class="e-button__icon"
      role="presentation"
      viewbox="0 0 98 96"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M48.854 0C21.839 0 0 22 0 49.217c0 21.756 13.993 40.172 33.405 46.69 2.427.49 3.316-1.059 3.316-2.362 0-1.141-.08-5.052-.08-9.127-13.59 2.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015 4.934.326 7.523 5.052 7.523 5.052 4.367 7.496 11.404 5.378 14.235 4.074.404-3.178 1.699-5.378 3.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283 0-5.378 1.94-9.778 5.014-13.2-.485-1.222-2.184-6.275.486-13.038 0 0 4.125-1.304 13.426 5.052a46.97 46.97 0 0 1 12.214-1.63c4.125 0 8.33.571 12.213 1.63 9.302-6.356 13.427-5.052 13.427-5.052 2.67 6.763.97 11.816.485 13.038 3.155 3.422 5.015 7.822 5.015 13.2 0 18.905-11.404 23.06-22.324 24.283 1.78 1.548 3.316 4.481 3.316 9.126 0 6.6-.08 11.897-.08 13.526 0 1.304.89 2.853 3.316 2.364 19.412-6.52 33.405-24.935 33.405-46.691C97.707 22 75.788 0 48.854 0z"
        fill="currentColor"
      />
    </svg>
    <span class="is-invisible">Find us on GitHub</span>
  </a>
  <p class="l-footer__impressum e-heading__6">
    This
    <a href="https://github.com/CodeYourFuture/immersive-go-course/"
      >free and open source engineering programme</a
    >
    is a project of
    <a href="https://codeyourfuture.io">Code Your Future</a>
    <br />
    This work is licensed under a Creative Commons Attribution-ShareAlike 4.0
    International License.
  </p>
  <button
    id="mode-toggle"
    class="e__button--toggle e-button--icon l-footer__mode"
  >
    <svg
      xmlns="http://www.w3.org/2000/svg"
      fill="none"
      viewBox="0 0 24 24"
      stroke-width="1.5"
      stroke="currentColor"
      class="e-icon e__button__icon e-icon--moon"
    >
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        d="M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z"
      />
    </svg>

    <span class="is-invisible">Toggle between light and dark mode</span>
  </button>
</footer>

  

<script>
  function randomBG() {
    const style = document.createElement("style");
    style.textContent = `body, html {background-image:url("\/pictures/svgs/neons/nnneon.svg"),url("\/pictures/svgs/quads/qqquad-5.svg"),radial-gradient(circle,var(--theme-color--paper) 0%,var(--theme-color--block) 50%,var(--theme-color--paper) 100%);
      background-size: cover;
    }`;

    document.head.appendChild(style);
  }

  window.addEventListener("load", randomBG);
</script>


<script src="/scripts/app.min.js" defer></script>


</div>
</body>
