<!DOCTYPE html>




<html lang="en-gb">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>CYF&#43;</title>
    <meta name="description" content="A free and open source immersive engineering programme. Practical, hands on projects in Go, distributed systems engineering, site reliability engineering, software engineering. Pace, scale, and complexity." />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    
    <style>
      body,
      html {
        margin: 0;
        padding: 0;
        height: 100%;
        animation: fade-in 0.2s;
      }
      @keyframes fade-in {
        0% {
          opacity: 0;
        }
        100% {
          opacity: 1;
        }
      }
    </style>
     
    <link
      rel="stylesheet"
      href="/bundled.min.f44ec27dd539fe9647de9751483e4bcd.css"
      media="print"
      onload="this.media='all'"
    />
    <noscript>
      <link rel="stylesheet" href="/bundled.min.f44ec27dd539fe9647de9751483e4bcd.css" />
    </noscript>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Hanken+Grotesk:wght@300;400;700&family=Major+Mono+Display&display=swap"
      rel="stylesheet"
      media="print"
      onload="this.media='all'"
    />

    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="/favicons/apple-touch-icon.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="/favicons/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="/favicons/favicon-16x16.png"
    />
    <link rel="manifest" href="/favicons/site.webmanifest" />
    <link rel="shortcut icon" href="/favicons/favicon.ico" />
    <meta name="apple-mobile-web-app-title" content="CYF+" />
    <meta name="application-name" content="CYF+" />
    <meta name="msapplication-TileColor" content="#9f00a7" />
    <meta
      name="msapplication-config"
      content="/favicons/browserconfig.xml"
    />
    <meta name="theme-color" content="#00ff90" />
  </head>
</html>
<body class="is-light-mode">
  <a class="c-skip-link e-button" id="skip-link" href="#main">Skip to main</a>
  <div class="l-layout">
    <header class="l-layout__header l-header">
  <div class="l-header__nav">
    <h1 class="l-header__heading">
      <a class="l-header__home" href="/">CYF&#43;</a>
    </h1>

    <button
      class="l-header__action e-button e-button--icon js-menu-toggle is-fixed"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 24 24"
        stroke-width="1.5"
        stroke="currentColor"
        class="e-button__icon l-header__icon"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M12 6.75a.75.75 0 110-1.5.75.75 0 010 1.5zM12 12.75a.75.75 0 110-1.5.75.75 0 010 1.5zM12 18.75a.75.75 0 110-1.5.75.75 0 010 1.5z"
        />
      </svg>

      <span class="is-invisible">Open Menu.</span>
    </button>
  </div>
</header>
 <nav
  class="l-layout__menu l-menu"
  aria-label="Main Site Links."
  id="site-menu"
  hidden
  tabindex="0"
>
  <div class="l-menu__container">
    <h2 class="l-menu__heading e-heading__2">
      <a href="/" class="l-menu__home">CYF&#43;</a>
    </h2>
    <button
      class="l-menu__action e-button e-button--icon js-menu-toggle"
      id="close-menu"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 24 24"
        stroke-width="1.5"
        stroke="currentColor"
        class="e-button__icon"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M6 18L18 6M6 6l12 12"
        />
      </svg>

      <span class="is-invisible">Close Menu.</span>
    </button>
    <ul class="l-menu__primary e-list">
      <li class="l-menu__item e-list__item">
        <a class="l-menu__link e-link e-heading__1" href="/about">About</a>
      </li>
      <li class="l-menu__item e-list__item">
        <a class="l-menu__link e-link e-heading__1" href="/versions"
          >Versions</a
        >
      </li>
      <li class="l-menu__item e-list__item">
        <a class="l-menu__link e-link e-heading__1" href="/projects"
          >Projects</a
        >
      </li>
      <li class="l-menu__item e-list__item">
        <a class="l-menu__link e-link e-heading__1" href="/primers">Primers</a>
      </li>
    </ul>

    <div class="l-menu__secondary">
      
      <a class="l-menu__link e-link" href="#skip-link">
        <span class="is-invisible">To top</span>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          width="48px"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
          class="l-menu__icon"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M3 4.5h14.25M3 9h9.75M3 13.5h5.25m5.25-.75L17.25 9m0 0L21 12.75M17.25 9v12"
          />
        </svg>
      </a>
      
    </div>
  </div>

  <img
    src="/pictures/depths/dddepth--005.webp"
    alt=""
    class="l-menu__bg"
  />
</nav>

    <main id="main" class="l-layout__main l-main" tabindex="0">
      

<article>
  <header class="l-page__header c-page-header">
    <div class="c-page-header__container">
      <div class="c-page-header__breadcrumbs">
        
<nav class="c-breadcrumbs">
  <ol class="c-breadcrumbs__list">
    <li class="c-breadcrumbs__item">
      <a class="c-breadcrumbs__link" href="/projects/">Projects</a>
    </li>
  </ol>
</nav>


      </div>
      <h1
        class="c-page-header__title e-heading__1 is-invisible"
      >
        CLI &amp; Files
      </h1>
         
      <a
        class="c-page-header__edit e-heading__5 e-link is-none--lt-container"
        href="https://github.com/CodeYourFuture/immersive-go-course/tree/main/projects/cli-files/README.md"
        >Edit on Github</a
      >
       

  

  


<h2 class="c-lastmod c-page-header__lastmod">
  .Lastmod
  <a href="https://github.com/CodeYourFuture/immersive-go-course/tree/main/cli-files">
    <time datetime="2023-01-08T15:59:51Z">2023-01-08T15:59:51Z</time>
  </a>
</h2>

  
      <section class="c-page-header__toc c-toc" id="toc">
        <nav id="TableOfContents">
  <ol>
    <li><a href="#objectives">Objectives:</a></li>
    <li><a href="#project">Project</a>
      <ol>
        <li><a href="#go-ls">go-ls</a></li>
        <li><a href="#go-cat">go-cat</a></li>
      </ol>
    </li>
    <li><a href="#extensions">Extensions</a>
      <ol>
        <li><a href="#go-ls-1">go-ls</a></li>
        <li><a href="#go-cat-1">go-cat</a></li>
      </ol>
    </li>
  </ol>
</nav>
      </section>
      
    </div>
  </header>

  <section class="l-page__main c-copy"><p>In this project you&rsquo;re going to get familiar with the <a href="https://go.dev/">Go programming language</a> by rebuilding two very common tools that programmers and computer administrators use all the time: <a href="https://en.m.wikipedia.org/wiki/Cat_(Unix)">cat</a> and <a href="https://en.m.wikipedia.org/wiki/Ls">ls</a>.</p>
<p>Timebox: 4 days</p>
<h2 id="objectives">Objectives:</h2>
<ul>
<li>Install and use <a href="https://github.com/spf13/cobra#overview">cobra</a></li>
<li>Use go build/go install/go get etc</li>
<li>Understand what a process is &amp; the basics of process - lifecycle</li>
<li>Accept arguments on the CLI</li>
<li>Open, read (and close) files from CLI arguments</li>
<li>Reading directories for files</li>
</ul>
<h2 id="project">Project</h2>
<p>You&rsquo;re going to build a command-line application that reads data from your computer&rsquo;s file system.</p>
<p>Let&rsquo;s say you have a few files containing poems in a directory:</p>
<ul>
<li><code>dew.txt</code></li>
<li><code>for_you.txt</code></li>
<li><code>rain.txt</code></li>
</ul>
<p>The <code>ls</code> tool will list the files in that directory:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>&gt; ls
</span></span><span style="display:flex;"><span>dew.txt
</span></span><span style="display:flex;"><span>for_you.txt
</span></span><span style="display:flex;"><span>rain.txt
</span></span></code></pre></div><blockquote>
<p>üí° See the <a href="../prep/README.md#command-line-examples">prep README.md</a> for an explanation of this command line example.</p>
</blockquote>
<p>While the <code>cat</code> command will output the contents of a file to you:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>&gt; cat dew.txt
</span></span><span style="display:flex;"><span>‚ÄúA World of Dew‚Äù by Kobayashi Issa
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>A world of dew,
</span></span><span style="display:flex;"><span>And within every dewdrop
</span></span><span style="display:flex;"><span>A world of struggle.
</span></span></code></pre></div><p>As you can see, <code>cat</code> takes an argument, namely the file to be written out. You&rsquo;ll learn how to do this too.</p>
<p>You&rsquo;re going to rebuild these two tools in Go:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>&gt; go-ls
</span></span><span style="display:flex;"><span>dew.txt
</span></span><span style="display:flex;"><span>for_you.txt
</span></span><span style="display:flex;"><span>rain.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt; go-cat dew.txt
</span></span><span style="display:flex;"><span>‚ÄúA World of Dew‚Äù by Kobayashi Issa
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>A world of dew,
</span></span><span style="display:flex;"><span>And within every dewdrop
</span></span><span style="display:flex;"><span>A world of struggle.
</span></span></code></pre></div><h3 id="go-ls">go-ls</h3>
<p>These steps will leave some work for you to do. If something&rsquo;s not clear, search around for to find the answer. If you&rsquo;re stuck for half an hour at most, ask for help. Remember to use Git to store your progress, committing often in small increments with useful descriptions.</p>
<p>A full implementation of this is available on the <code>impl/cat-ls</code> branch.</p>
<p>The <code>go-ls</code> directory is provided for you with some example files in the <code>assets/</code> folder.</p>
<p>In your command line/terminal, make sure your working directory is go-ls: <code>cd go-ls</code></p>
<p>Create <code>go.mod</code>, <code>main.go</code>, <code>cmd/root.go</code>. The <code>touch</code> command creates files: <code>touch go.mod</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// go.mod
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">module</span> <span style="color:#66d9ef">go</span><span style="color:#f92672">-</span><span style="color:#a6e22e">ls</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">go</span> <span style="color:#ae81ff">1.18</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// main.go
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;go-ls/cmd&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">cmd</span>.<span style="color:#a6e22e">Execute</span>()
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// cmd/root.go
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">package</span> <span style="color:#a6e22e">cmd</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">Execute</span>() {}
</span></span></code></pre></div><p>We&rsquo;re going to use the <a href="https://github.com/spf13/cobra#overview">Cobra</a> package to make these commands. It does a lot of magic for you.</p>
<p>Install the Cobra package using the <code>go get</code> command: <code>go get -u github.com/spf13/cobra@latest</code></p>
<p>The Cobra <a href="https://github.com/spf13/cobra/blob/master/user_guide.md">user guide</a> will show you how to make a root command that prints hello in <code>cmd/root.go</code>.</p>
<p>To use your command, install and run it: <code>go install .</code></p>
<p>To run the code, you need to tell your command line where executable code compiled from go lives. The way to do this is different depending on your operating system, but here&rsquo;s <a href="https://go.dev/doc/install">a guide on the Go website</a> ‚Äî look at anything that mentions <code>go/bin</code> on your <code>PATH</code>.</p>
<p>Once added, you should now be able to run <code>go-ls</code>.</p>
<p>Now, when you change your code, install and run it: <code>go install . &amp;&amp; go-ls</code></p>
<p>Now you&rsquo;ve got something working, we&rsquo;ll speed up the steps. You can do it!</p>
<p>The <code>ls</code> command reads a directory, generating a list of files or sub-directories. Go comes with packages for interacting with files built-in, include a package called <a href="https://pkg.go.dev/os">os</a>, which contains a function called <code>ReadDir</code> which will do lots of the work of <code>ls</code> for you.</p>
<p>See if you can implement basic <code>ls</code> with <code>os.ReadDir</code>. It should read the list of files in the current, &ldquo;working&rdquo; directory:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>&gt; go install .
</span></span><span style="display:flex;"><span>&gt; cd assets
</span></span><span style="display:flex;"><span>&gt; go-ls
</span></span><span style="display:flex;"><span>dew.txt
</span></span><span style="display:flex;"><span>for_you.txt
</span></span><span style="display:flex;"><span>rain.txt
</span></span></code></pre></div><p>The real <code>ls</code> allows you pass a directory to be read: <code>ls assets</code>.</p>
<p>Extend your <code>go-ls</code> to allow the command to take arguments (look for <code>cobra.ArbitraryArgs</code>) and then, when passed an argument such as <code>go-ls assets</code>, read from the passed directory.</p>
<p>Make that this directory path can be relative: <code>go-ls ..</code> and <code>go-ls ../go-ls</code> should both work.</p>
<p>Handle the error <code>Error: fdopendir go.mod: not a directory</code> when passing <code>go-ls</code> a file argument: <code>go-ls go.mod</code>. Think hard about why this is happening before you try to fix it.</p>
<p>Update <code>go-ls</code> to match <code>ls</code> in terms of how it handles files (hint: <code>os.Stat</code>) ‚Äî it should just output the name of the file.</p>
<p>Make <code>go-ls -h</code> include a helpful description.</p>
<h3 id="go-cat">go-cat</h3>
<p>This one we&rsquo;re going to make in a different way, so we can see how to use tools to initialise go projects more quickly.</p>
<p>We&rsquo;ll use the <a href="https://github.com/spf13/cobra-cli/blob/main/README.md">cobra-cli</a> to initialise a new project. There&rsquo;s a guide on that page to installing it, but it&rsquo;s likely <code>go install github.com/spf13/cobra-cli@latest</code>.</p>
<p>Then <code>cd</code> to the <code>cli-files</code> directory.</p>
<p>Make a <code>go-cat</code> directory, <code>cd</code> into it, and run <code>go mod init go-cat</code> (<a href="https://pkg.go.dev/cmd/go#hdr-Initialize_new_module_in_current_directory">documentation here</a>).</p>
<p>Then run <code>cobra-cli init .</code>. <a href="https://github.com/spf13/cobra-cli/blob/main/README.md">This command</a> will create your initial application code for you.</p>
<p>Take a look at all the files it has created. See how they differ or are similar to what you did in the <code>go-ls</code> example.</p>
<p>Let&rsquo;s try it out: <code>go install . &amp;&amp; go-cat</code>. It will do nothing, but it&rsquo;s a start.</p>
<p>Now it&rsquo;s over to you: set up a command that takes a path to a file as an argument, then opens that file and prints it out. You&rsquo;ll need the built-in go functions <code>os.ReadFile</code> and <code>os.Stdout.Write</code>, as well as more from the <code>os</code> package.</p>
<h2 id="extensions">Extensions</h2>
<p>These are optional, if you have time, but it&rsquo;s highly recommended that you try them out.</p>
<h3 id="go-ls-1">go-ls</h3>
<ol>
<li>Write some tests for <code>go-ls</code></li>
<li>Extend <code>go-ls</code> to support some more features of the real <code>ls</code> (for example, <code>ls -m assets</code>)</li>
</ol>
<h3 id="go-cat-1">go-cat</h3>
<ol>
<li>Handle the error if you pass it a directory rather than a file, like the real <code>cat</code> does.</li>
<li>What happens if you pass the real <code>cat</code> multiple arguments? Do the same.</li>
<li>Find out what passing <code>-n</code> does to the real <code>cat</code>. Implement support for that too.</li>
</ol>
</section>

  
<footer class="c-page-footer c-copy">
  <h4 class="c-page-footer__section">
    <a
      class="c-page-footer__section-link e-link"
      href="/projects"
      >projects</a
    >
  </h4>
   
  <nav class="c-page-footer__section-nav">
    <a
      class="e-button e-button--icon c-page-footer__edit"
      href="https://github.com/CodeYourFuture/immersive-go-course/tree/main/projects/cli-files/README.md"
      ><svg
        role="presentation"
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 24 24"
        stroke-width="1.5"
        stroke="currentColor"
        class="e-button__icon"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"
        />
      </svg>
      <span class="is-invisible">Edit this page on GitHub</span></a
    >
    
    
  </nav>
</footer>


</article>


    </main><footer class="l-layout__footer l-footer">
  <a
    class="l-footer__github e-button e-button--icon"
    href="https://github.com/CodeYourFuture/immersive-go-course/"
  >
    <svg
      focusable="false"
      class="e-button__icon"
      role="presentation"
      viewbox="0 0 98 96"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M48.854 0C21.839 0 0 22 0 49.217c0 21.756 13.993 40.172 33.405 46.69 2.427.49 3.316-1.059 3.316-2.362 0-1.141-.08-5.052-.08-9.127-13.59 2.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015 4.934.326 7.523 5.052 7.523 5.052 4.367 7.496 11.404 5.378 14.235 4.074.404-3.178 1.699-5.378 3.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283 0-5.378 1.94-9.778 5.014-13.2-.485-1.222-2.184-6.275.486-13.038 0 0 4.125-1.304 13.426 5.052a46.97 46.97 0 0 1 12.214-1.63c4.125 0 8.33.571 12.213 1.63 9.302-6.356 13.427-5.052 13.427-5.052 2.67 6.763.97 11.816.485 13.038 3.155 3.422 5.015 7.822 5.015 13.2 0 18.905-11.404 23.06-22.324 24.283 1.78 1.548 3.316 4.481 3.316 9.126 0 6.6-.08 11.897-.08 13.526 0 1.304.89 2.853 3.316 2.364 19.412-6.52 33.405-24.935 33.405-46.691C97.707 22 75.788 0 48.854 0z"
        fill="currentColor"
      />
    </svg>
    <span class="is-invisible">Find us on GitHub</span>
  </a>
  <p class="l-footer__impressum e-heading__6">
    This
    <a href="https://github.com/CodeYourFuture/immersive-go-course/"
      >free and open source engineering programme</a
    >
    is a project of
    <a href="https://codeyourfuture.io">Code Your Future</a>
    <br />
    This work is licensed under a Creative Commons Attribution-ShareAlike 4.0
    International License.
  </p>
  <button
    id="mode-toggle"
    class="e__button--toggle e-button--icon l-footer__mode"
  >
    <svg
      xmlns="http://www.w3.org/2000/svg"
      fill="none"
      viewBox="0 0 24 24"
      stroke-width="1.5"
      stroke="currentColor"
      class="e-icon e__button__icon e-icon--moon"
    >
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        d="M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z"
      />
    </svg>

    <span class="is-invisible">Toggle between light and dark mode</span>
  </button>
</footer>

  

<script>
  function randomBG() {
    const style = document.createElement("style");
    style.textContent = `body, html {background-image:url("\/pictures/svgs/neons/nnneon.svg"),url("\/pictures/svgs/quads/qqquad-5.svg"),radial-gradient(circle,var(--theme-color--paper) 0%,var(--theme-color--block) 50%,var(--theme-color--paper) 100%);
      background-size: cover;
    }`;

    document.head.appendChild(style);
  }

  window.addEventListener("load", randomBG);
</script>


<script src="/scripts/app.min.js" defer></script>


</div>
</body>
